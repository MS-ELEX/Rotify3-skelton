{
  "version": 3,
  "sources": ["../cachewrap/index.js", "dep:@roxi_routify__cachewrap"],
  "sourcesContent": ["/**\n * @callback IdGenerator\n * @param {any[]} params\n * @returns {any}\n */\n\n/** @type {IdGenerator} */\nconst _idGenerator = params => params.map(param => param.toString()).join('-')\n\n/**\n * @param {IdGenerator} defaultIdGenerator \n */\nconst createCacheWrap = (defaultIdGenerator = _idGenerator) => {\n    const cache = new Map()\n\n    /**\n     * @template {(...params: any[]) => any} T\n     * @param {T} fn\n     * @param {IdGenerator} idGenerator\n     * @returns {T & {refresh: T}}\n     */\n    const cacheWrap = (fn, idGenerator = defaultIdGenerator) => {\n        const wrapped = (...params) => {\n            const id = idGenerator(params)\n            if (!cache.has(id)) {\n                const result = fn(...params)\n                if (result && result.then) {\n                    return new Promise(resolve => {\n                        result.then(res => {\n                            cache.set(id, res)\n                            resolve(res)\n                        })\n                    })\n                } else cache.set(id, result)\n            }\n            return cache.get(id)\n        }\n\n        wrapped.refresh = (...params) => {\n            const id = idGenerator(params)\n            cache.delete(id)\n            return wrapped(...params)\n        }\n\n        /** @ts-ignore */\n        return wrapped\n    }\n\n    return cacheWrap\n}\n\nmodule.exports = createCacheWrap", "export default require(\"./node_modules/cachewrap/index.js\");"],
  "mappings": ";;;;;AAAA;AAAA;AAOA,QAAM,eAAe,YAAU,OAAO,IAAI,WAAS,MAAM,YAAY,KAAK;AAK1E,QAAM,kBAAkB,CAAC,qBAAqB,iBAAiB;AAC3D,YAAM,QAAQ,IAAI;AAQlB,YAAM,YAAY,CAAC,IAAI,cAAc,uBAAuB;AACxD,cAAM,UAAU,IAAI,WAAW;AAC3B,gBAAM,KAAK,YAAY;AACvB,cAAI,CAAC,MAAM,IAAI,KAAK;AAChB,kBAAM,SAAS,GAAG,GAAG;AACrB,gBAAI,UAAU,OAAO,MAAM;AACvB,qBAAO,IAAI,QAAQ,aAAW;AAC1B,uBAAO,KAAK,SAAO;AACf,wBAAM,IAAI,IAAI;AACd,0BAAQ;AAAA;AAAA;AAAA;AAGb,oBAAM,IAAI,IAAI;AAAA;AAEzB,iBAAO,MAAM,IAAI;AAAA;AAGrB,gBAAQ,UAAU,IAAI,WAAW;AAC7B,gBAAM,KAAK,YAAY;AACvB,gBAAM,OAAO;AACb,iBAAO,QAAQ,GAAG;AAAA;AAItB,eAAO;AAAA;AAGX,aAAO;AAAA;AAGX,WAAO,UAAU;AAAA;AAAA;;;ACnDjB,IAAO,iCAAQ;",
  "names": []
}
